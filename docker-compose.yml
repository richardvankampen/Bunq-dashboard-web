version: '3.8'

services:
  bunq-dashboard:
    build: .
    container_name: bunq-dashboard
    restart: unless-stopped

    ports:
      # Single port for both API and Frontend (simplified architecture)
      # Access: http://your-nas-ip:5000 (via VPN only!)
      - "5000:5000"

    # Load all settings from .env
    env_file:
      - .env

    volumes:
      # Persistent storage for Bunq context and logs (Synology bind mounts)
      - /volume1/docker/bunq-dashboard/config:/app/config
      - /volume1/docker/bunq-dashboard/logs:/app/logs

    networks:
      - bridge

    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5000/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 20s

# Network configuration
networks:
  bridge:
    external: true
    # Optional: specify subnet
    # ipam:
    #   config:
    #     - subnet: 172.28.0.0/16

# ============================================
# USAGE EXAMPLES
# ============================================
#
# Build:
#   docker-compose build
#   docker-compose up -d
#
# View logs:
#   docker-compose logs -f bunq-dashboard
#
# Restart services:
#   docker-compose restart
#
# Stop services:
#   docker-compose down
#
# Rebuild without cache:
#   docker-compose build --no-cache
#   docker-compose up -d
#
# ============================================
